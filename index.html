<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Control de Acceso por Reconocimiento Facial</title>
  <link rel="manifest" href="manifest.json">

  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend+Deca:wght@100..900&display=swap" rel="stylesheet">

  <script defer src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>

  <script type="module" src="js/app.js"></script>
</head>

<body>
  <div class="main-wrapper">
    <div class="container">
      <div class="language-switcher">
        <span class="lang-es">ES</span>
        <label class="switch">
          <input type="checkbox" id="language-toggle">
          <span class="slider round"></span>
        </label>
        <span class="lang-en">EN</span>
      </div>
      <div class="content">

        <!-- HOME -->
        <section id="home-screen" class="screen active">
          <h1 class="titulo" data-i18n="welcome">Bienvenido</h1>
          <p class="intro" data-i18n="intro">Sistema de reconocimiento facial para registro y autenticación de usuarios
          </p>

          <!-- LOGO: centered, controlled size -->
          <div class="logo">
            <img src="icono.png" alt="Logo de la empresa">
          </div>

          <p class="subtitle">Seleccione una opción para continuar:</p>

          <div class="action-buttons">
            <button id="ingreso-btn" class="btn btn-success"><span data-i18n="register_income">Registrar Ingreso</span></button>
            <button id="egreso-btn" class="btn btn-secondary"><span data-i18n="register_exit">Registrar Egreso</span></button>
          </div>
        </section>

        <!-- LOGIN (ingreso / egreso) -->
        <section id="login-screen" class="screen">
          <h2 id="login-title">Registro de Ingreso/Egreso</h2>
          <p id="login-description">Por favor, colóquese frente a la cámara.</p>

          <div class="video-container">
            <video id="login-video" autoplay muted playsinline></video>
            <canvas id="login-overlay"></canvas>
          </div>

          <div id="login-status" class="status info">Buscando coincidencias...</div>

          <div class="action-buttons">
            <button id="back-to-home-from-denied" class="btn btn-secondary" data-i18n="back_to_home">Volver al Inicio</button>
          </div>

          <div id="manual-login" class="manual-login" style="display:none;">
            <h3>Inicio de Sesión Manual</h3>
            <div class="form-group">
              <label for="manual-operator-code" data-i18n="operator_code_label">Código:</label>
              <input type="text" id="manual-operator-code">
            </div>
            <div class="form-group">
              <label for="manual-operator-dni">DNI:</label>
              <input type="text" id="manual-operator-dni">
            </div>
            <button id="manual-login-btn" class="btn">Iniciar Sesión</button>
            <button id="retry-facial-login-btn" class="btn btn-secondary">Reintentar</button>
          </div>
        </section>

        <!-- ACCESO PERMITIDO -->
        <section id="access-granted-screen" class="screen">
          <div class="status success">
            <h2>¡Registro Exitoso!</h2>
            <p id="welcome-message"></p>
          </div>
          <div class="action-buttons-small">
            <button id="back-after-access" class="btn" data-i18n="back_to_home">Volver al Inicio</button>
            <button id="supervisor-menu-btn" class="btn btn-info" style="display:none;" data-i18n="supervisor_menu">Menú Supervisor</button>
          </div>
        </section>

        <!-- ACCESO PENDIENTE DE REVISION -->
        <section id="access-pending-review-screen" class="screen">
          <div class="status warning"> <!-- Usamos una clase 'warning' para un estilo visual diferente -->
            <h2 data-i18n="access_granted_pending_title">Ingreso Registrado</h2>
            <p data-i18n="access_granted_pending_message">Su ingreso ha sido registrado, pero está fuera de su turno y será revisado por un supervisor.</p>
          </div>
          <div class="action-buttons-small">
            <button id="back-after-pending-review" class="btn" data-i18n="understood">Entendido</button>
          </div>
        </section>

        <!-- ACCESO DENEGADO -->
        <section id="access-denied-screen" class="screen">
          <div class="status error">
            <h2 id="denial-title" data-i18n="access_denied_title">Acceso Denegado</h2>
            <p id="denial-reason"></p>
          </div>
          <div class="action-buttons-small">
            <button id="try-again-btn" class="btn" data-i18n="try_again">Intentar Nuevamente</button>
            <button id="back-to-home-from-denied-2" class="btn btn-secondary" data-i18n="back_to_home">Volver al Inicio</button>
          </div>
          <button id="supervisor-menu-btn-denied" class="btn btn-info" style="display:none;">Menú Supervisor</button>
        </section>

        <!-- Pantalla de Autorización Pendiente -->
        <section id="pending-authorization-screen" class="screen">
          <div class="status-icon pending">⏳</div>
          <h2 data-i18n="pending_authorization_title">Solicitud Enviada</h2>
          <p id="pending-auth-message" data-i18n="pending_authorization_message">Su solicitud de acceso ha sido enviada a un supervisor para su aprobación.</p>
          <button id="back-to-home-from-pending" class="btn btn-primary" data-i18n="understood">Entendido</button>
        </section>

      </div>
    </div>
  </div>
</body>

</html>